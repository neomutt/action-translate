notifications:
  email:
    recipients:
      - rich@flatcap.org
    on_success: change
    on_failure: always

sudo: false
dist: trusty

language: c
compiler: gcc

addons:
  apt:
    packages:
      - gettext

git:
  depth: 3

env:
  global:
  - DEPLOY_REPO="git@github.com:neomutt/neomutt.github.io.git"
  - DEPLOY_DIR="~/website"
  - DEPLOY_FILE="translate.html"

script:
- .travis/stats.sh po/*.po

after_success:
- .travis/prep.sh
- eval "$(ssh-agent -s)"
- ssh-add .travis/travis-deploy-github.pem
- git clone "$DEPLOY_REPO" "$DEPLOY_DIR"
- .travis/generate-webpage.sh po/*.po > "$DEPLOY_DIR/$DEPLOY_FILE"
- cd "$DEPLOY_DIR"
    && git add "$DEPLOY_FILE"
    && git commit -m "[AUTO] update translations leaderboard" -m "[ci skip]"
    && git push origin

